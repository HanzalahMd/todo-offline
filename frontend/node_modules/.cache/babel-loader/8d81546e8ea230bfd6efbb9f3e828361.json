{"ast":null,"code":"/**\n * this plugin adds the leader-election-capabilities to rxdb\n */\nimport { createLeaderElection } from 'broadcast-channel';\nexport var LeaderElector =\n/*#__PURE__*/\nfunction () {\n  function LeaderElector(database) {\n    this.destroyed = false;\n    this.isLeader = false;\n    this.isDead = false;\n    this.database = database;\n    this.elector = createLeaderElection(database.broadcastChannel);\n  }\n\n  var _proto = LeaderElector.prototype;\n\n  _proto.die = function die() {\n    return this.elector.die();\n  };\n\n  _proto.waitForLeadership = function waitForLeadership() {\n    var _this = this;\n\n    return this.elector.awaitLeadership().then(function () {\n      _this.isLeader = true;\n      return true;\n    });\n  };\n\n  _proto.destroy = function destroy() {\n    if (this.destroyed) return;\n    this.destroyed = true;\n    this.isDead = true;\n    return this.die();\n  };\n\n  return LeaderElector;\n}();\nexport function create(database) {\n  var elector = new LeaderElector(database);\n  return elector;\n}\nexport var rxdb = true;\nexport var prototypes = {};\nexport var overwritable = {\n  createLeaderElector: create\n};\nvar plugin = {\n  rxdb: rxdb,\n  prototypes: prototypes,\n  overwritable: overwritable\n};\nexport default plugin;","map":{"version":3,"sources":["/Users/Hanzalah/Desktop/github/todo-offline/rxdb-hasura-demo/node_modules/rxdb/dist/es/plugins/leader-election.js"],"names":["createLeaderElection","LeaderElector","database","destroyed","isLeader","isDead","elector","broadcastChannel","_proto","prototype","die","waitForLeadership","_this","awaitLeadership","then","destroy","create","rxdb","prototypes","overwritable","createLeaderElector","plugin"],"mappings":"AAAA;;;AAGA,SAASA,oBAAT,QAAqC,mBAArC;AACA,OAAO,IAAIC,aAAa;AAAG;AAAa,YAAY;AAClD,WAASA,aAAT,CAAuBC,QAAvB,EAAiC;AAC/B,SAAKC,SAAL,GAAiB,KAAjB;AACA,SAAKC,QAAL,GAAgB,KAAhB;AACA,SAAKC,MAAL,GAAc,KAAd;AACA,SAAKH,QAAL,GAAgBA,QAAhB;AACA,SAAKI,OAAL,GAAeN,oBAAoB,CAACE,QAAQ,CAACK,gBAAV,CAAnC;AACD;;AAED,MAAIC,MAAM,GAAGP,aAAa,CAACQ,SAA3B;;AAEAD,EAAAA,MAAM,CAACE,GAAP,GAAa,SAASA,GAAT,GAAe;AAC1B,WAAO,KAAKJ,OAAL,CAAaI,GAAb,EAAP;AACD,GAFD;;AAIAF,EAAAA,MAAM,CAACG,iBAAP,GAA2B,SAASA,iBAAT,GAA6B;AACtD,QAAIC,KAAK,GAAG,IAAZ;;AAEA,WAAO,KAAKN,OAAL,CAAaO,eAAb,GAA+BC,IAA/B,CAAoC,YAAY;AACrDF,MAAAA,KAAK,CAACR,QAAN,GAAiB,IAAjB;AACA,aAAO,IAAP;AACD,KAHM,CAAP;AAID,GAPD;;AASAI,EAAAA,MAAM,CAACO,OAAP,GAAiB,SAASA,OAAT,GAAmB;AAClC,QAAI,KAAKZ,SAAT,EAAoB;AACpB,SAAKA,SAAL,GAAiB,IAAjB;AACA,SAAKE,MAAL,GAAc,IAAd;AACA,WAAO,KAAKK,GAAL,EAAP;AACD,GALD;;AAOA,SAAOT,aAAP;AACD,CAhCuC,EAAjC;AAiCP,OAAO,SAASe,MAAT,CAAgBd,QAAhB,EAA0B;AAC/B,MAAII,OAAO,GAAG,IAAIL,aAAJ,CAAkBC,QAAlB,CAAd;AACA,SAAOI,OAAP;AACD;AACD,OAAO,IAAIW,IAAI,GAAG,IAAX;AACP,OAAO,IAAIC,UAAU,GAAG,EAAjB;AACP,OAAO,IAAIC,YAAY,GAAG;AACxBC,EAAAA,mBAAmB,EAAEJ;AADG,CAAnB;AAGP,IAAIK,MAAM,GAAG;AACXJ,EAAAA,IAAI,EAAEA,IADK;AAEXC,EAAAA,UAAU,EAAEA,UAFD;AAGXC,EAAAA,YAAY,EAAEA;AAHH,CAAb;AAKA,eAAeE,MAAf","sourcesContent":["/**\n * this plugin adds the leader-election-capabilities to rxdb\n */\nimport { createLeaderElection } from 'broadcast-channel';\nexport var LeaderElector = /*#__PURE__*/function () {\n  function LeaderElector(database) {\n    this.destroyed = false;\n    this.isLeader = false;\n    this.isDead = false;\n    this.database = database;\n    this.elector = createLeaderElection(database.broadcastChannel);\n  }\n\n  var _proto = LeaderElector.prototype;\n\n  _proto.die = function die() {\n    return this.elector.die();\n  };\n\n  _proto.waitForLeadership = function waitForLeadership() {\n    var _this = this;\n\n    return this.elector.awaitLeadership().then(function () {\n      _this.isLeader = true;\n      return true;\n    });\n  };\n\n  _proto.destroy = function destroy() {\n    if (this.destroyed) return;\n    this.destroyed = true;\n    this.isDead = true;\n    return this.die();\n  };\n\n  return LeaderElector;\n}();\nexport function create(database) {\n  var elector = new LeaderElector(database);\n  return elector;\n}\nexport var rxdb = true;\nexport var prototypes = {};\nexport var overwritable = {\n  createLeaderElector: create\n};\nvar plugin = {\n  rxdb: rxdb,\n  prototypes: prototypes,\n  overwritable: overwritable\n};\nexport default plugin;\n//# sourceMappingURL=leader-election.js.map"]},"metadata":{},"sourceType":"module"}