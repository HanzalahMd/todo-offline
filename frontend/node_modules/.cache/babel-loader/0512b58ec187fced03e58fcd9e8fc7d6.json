{"ast":null,"code":"/**\n * this contains a mapping to basic dependencies\n * which should be easy to change\n */\nimport randomToken from 'random-token';\nimport { default as deepClone } from 'clone';\n/**\n * Returns an error that indicates that a plugin is missing\n * We do not throw a RxError because this should not be handled\n * programmatically but by using the correct import\n */\n\nexport function pluginMissing(pluginKey) {\n  return new Error(\"You are using a function which must be overwritten by a plugin.\\n        You should either prevent the usage of this function or add the plugin via:\\n          - es5-require:\\n            RxDB.plugin(require('rxdb/plugins/\" + pluginKey + \"'))\\n          - es6-import:\\n            import \" + ucfirst(pluginKey) + \"Plugin from 'rxdb/plugins/\" + pluginKey + \"';\\n            RxDB.plugin(\" + ucfirst(pluginKey) + \"Plugin);\\n        \");\n}\n/**\n * this is a very fast hashing but its unsecure\n * @link http://stackoverflow.com/questions/7616461/generate-a-hash-from-string-in-javascript-jquery\n * @return a number as hash-result\n */\n\nexport function fastUnsecureHash(obj) {\n  if (typeof obj !== 'string') obj = JSON.stringify(obj);\n  var hashValue = 0,\n      i,\n      chr,\n      len;\n  if (obj.length === 0) return hashValue;\n\n  for (i = 0, len = obj.length; i < len; i++) {\n    chr = obj.charCodeAt(i); // tslint:disable-next-line\n\n    hashValue = (hashValue << 5) - hashValue + chr; // tslint:disable-next-line\n\n    hashValue |= 0; // Convert to 32bit integer\n  }\n\n  if (hashValue < 0) hashValue = hashValue * -1;\n  return hashValue;\n}\n/**\n *  spark-md5 is used here\n *  because pouchdb uses the same\n *  and build-size could be reduced by 9kb\n */\n\nimport Md5 from 'spark-md5';\nexport function hash(obj) {\n  var msg = obj;\n  if (typeof obj !== 'string') msg = JSON.stringify(obj);\n  return Md5.hash(msg);\n}\n/**\n * generate a new _id as db-primary-key\n */\n\nexport function generateId() {\n  return randomToken(10) + ':' + new Date().getTime();\n}\n/**\n * returns a promise that resolves on the next tick\n */\n\nexport function nextTick() {\n  return new Promise(function (res) {\n    return setTimeout(res, 0);\n  });\n}\nexport function promiseWait() {\n  var ms = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  return new Promise(function (res) {\n    return setTimeout(res, ms);\n  });\n}\nexport function toPromise(maybePromise) {\n  if (maybePromise && typeof maybePromise.then === 'function') {\n    // is promise\n    return maybePromise;\n  } else {\n    return Promise.resolve(maybePromise);\n  }\n}\nexport function requestIdlePromise() {\n  var timeout = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\n  if (typeof window === 'object' && window['requestIdleCallback']) {\n    return new Promise(function (res) {\n      return window['requestIdleCallback'](res, {\n        timeout: timeout\n      });\n    });\n  } else return Promise.resolve();\n}\n/**\n * like Promise.all() but runs in series instead of parallel\n * @link https://github.com/egoist/promise.series/blob/master/index.js\n * @param tasks array with functions that return a promise\n */\n\nexport function promiseSeries(tasks, initial) {\n  return tasks.reduce(function (current, next) {\n    return current.then(next);\n  }, Promise.resolve(initial));\n}\n/**\n * run the callback if requestIdleCallback available\n * do nothing if not\n * @link https://developer.mozilla.org/de/docs/Web/API/Window/requestIdleCallback\n */\n\nexport function requestIdleCallbackIfAvailable(fun) {\n  if (typeof window === 'object' && window['requestIdleCallback']) window['requestIdleCallback'](fun);\n}\n/**\n * uppercase first char\n */\n\nexport function ucfirst(str) {\n  str += '';\n  var f = str.charAt(0).toUpperCase();\n  return f + str.substr(1);\n}\n/**\n * @link https://de.wikipedia.org/wiki/Base58\n * this does not start with the numbers to generate valid variable-names\n */\n\nvar base58Chars = 'abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ123456789';\nvar base58Length = base58Chars.length;\n/**\n * transform a number to a string by using only base58 chars\n * @link https://github.com/matthewmueller/number-to-letter/blob/master/index.js\n * @param nr                                       | 10000000\n * @return the string-representation of the number | '2oMX'\n */\n\nexport function numberToLetter(nr) {\n  var digits = [];\n\n  do {\n    var v = nr % base58Length;\n    digits.push(v);\n    nr = Math.floor(nr / base58Length);\n  } while (nr-- > 0);\n\n  return digits.reverse().map(function (d) {\n    return base58Chars[d];\n  }).join('');\n}\n/**\n * removes trailing and ending dots from the string\n */\n\nexport function trimDots(str) {\n  // start\n  while (str.charAt(0) === '.') {\n    str = str.substr(1);\n  } // end\n\n\n  while (str.slice(-1) === '.') {\n    str = str.slice(0, -1);\n  }\n\n  return str;\n}\n/**\n * deep-sort an object so its attributes are in lexical order.\n * Also sorts the arrays inside of the object if no-array-sort not set\n */\n\nexport function sortObject(obj) {\n  var noArraySort = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  if (!obj) return obj; // do not sort null, false or undefined\n  // array\n\n  if (!noArraySort && Array.isArray(obj)) {\n    return obj.sort(function (a, b) {\n      if (typeof a === 'string' && typeof b === 'string') return a.localeCompare(b);\n      if (typeof a === 'object') return 1;else return -1;\n    }).map(function (i) {\n      return sortObject(i);\n    });\n  } // object\n\n\n  if (typeof obj === 'object') {\n    if (obj instanceof RegExp) return obj;\n    var out = {};\n    Object.keys(obj).sort(function (a, b) {\n      return a.localeCompare(b);\n    }).forEach(function (key) {\n      out[key] = sortObject(obj[key]);\n    });\n    return out;\n  } // everything else\n\n\n  return obj;\n}\n/**\n * used to JSON.stringify() objects that contain a regex\n * @link https://stackoverflow.com/a/33416684 thank you Fabian Jakobs!\n */\n\nexport function stringifyFilter(key, value) {\n  if (value instanceof RegExp) return value.toString();\n  return value;\n}\n/**\n * get a random string which can be used with couchdb\n * @link http://stackoverflow.com/a/1349426/3443137\n */\n\nexport function randomCouchString() {\n  var length = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 10;\n  var text = '';\n  var possible = 'abcdefghijklmnopqrstuvwxyz';\n\n  for (var i = 0; i < length; i++) {\n    text += possible.charAt(Math.floor(Math.random() * possible.length));\n  }\n\n  return text;\n}\n/**\n * shuffle the given array\n */\n\nexport function shuffleArray(arr) {\n  return arr.sort(function () {\n    return Math.random() - 0.5;\n  });\n}\n/**\n * @link https://stackoverflow.com/a/15996017\n */\n\nexport function removeOneFromArrayIfMatches(ar, condition) {\n  ar = ar.slice();\n  var i = ar.length;\n  var done = false;\n\n  while (i-- && !done) {\n    if (condition(ar[i])) {\n      done = true;\n      ar.splice(i, 1);\n    }\n  }\n\n  return ar;\n}\n/**\n * transforms the given adapter into a pouch-compatible object\n */\n\nexport function adapterObject(adapter) {\n  var adapterObj = {\n    db: adapter\n  };\n\n  if (typeof adapter === 'string') {\n    adapterObj = {\n      adapter: adapter\n    };\n  }\n\n  return adapterObj;\n}\n\nfunction recursiveDeepCopy(o) {\n  if (!o) return o;\n  return deepClone(o, false);\n}\n\nexport var clone = recursiveDeepCopy;\n/**\n * does a flat copy on the objects,\n * is about 3 times faster then using deepClone\n * @link https://jsperf.com/object-rest-spread-vs-clone/2\n */\n\nexport function flatClone(obj) {\n  return Object.assign({}, obj);\n}\nimport isElectron from 'is-electron';\nexport var isElectronRenderer = isElectron();\n/**\n * returns a flattened object\n * @link https://gist.github.com/penguinboy/762197\n */\n\nexport function flattenObject(ob) {\n  var toReturn = {};\n\n  for (var i in ob) {\n    if (!ob.hasOwnProperty(i)) continue;\n\n    if (typeof ob[i] === 'object') {\n      var flatObject = flattenObject(ob[i]);\n\n      for (var _x in flatObject) {\n        if (!flatObject.hasOwnProperty(_x)) continue;\n        toReturn[i + '.' + _x] = flatObject[_x];\n      }\n    } else {\n      toReturn[i] = ob[i];\n    }\n  }\n\n  return toReturn;\n}\nexport function getHeightOfRevision(revString) {\n  var first = revString.split('-')[0];\n  return parseInt(first, 10);\n}\n/**\n * prefix of local documents\n * TODO check if this variable exists somewhere else\n */\n\nexport var LOCAL_PREFIX = '_local/';","map":{"version":3,"sources":["/Users/Hanzalah/Desktop/github/todo-offline/rxdb-hasura-demo/node_modules/rxdb/dist/es/util.js"],"names":["randomToken","default","deepClone","pluginMissing","pluginKey","Error","ucfirst","fastUnsecureHash","obj","JSON","stringify","hashValue","i","chr","len","length","charCodeAt","Md5","hash","msg","generateId","Date","getTime","nextTick","Promise","res","setTimeout","promiseWait","ms","arguments","undefined","toPromise","maybePromise","then","resolve","requestIdlePromise","timeout","window","promiseSeries","tasks","initial","reduce","current","next","requestIdleCallbackIfAvailable","fun","str","f","charAt","toUpperCase","substr","base58Chars","base58Length","numberToLetter","nr","digits","v","push","Math","floor","reverse","map","d","join","trimDots","slice","sortObject","noArraySort","Array","isArray","sort","a","b","localeCompare","RegExp","out","Object","keys","forEach","key","stringifyFilter","value","toString","randomCouchString","text","possible","random","shuffleArray","arr","removeOneFromArrayIfMatches","ar","condition","done","splice","adapterObject","adapter","adapterObj","db","recursiveDeepCopy","o","clone","flatClone","assign","isElectron","isElectronRenderer","flattenObject","ob","toReturn","hasOwnProperty","flatObject","_x","getHeightOfRevision","revString","first","split","parseInt","LOCAL_PREFIX"],"mappings":"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","sourcesContent":["/**\n * this contains a mapping to basic dependencies\n * which should be easy to change\n */\nimport randomToken from 'random-token';\nimport { default as deepClone } from 'clone';\n\n/**\n * Returns an error that indicates that a plugin is missing\n * We do not throw a RxError because this should not be handled\n * programmatically but by using the correct import\n */\nexport function pluginMissing(pluginKey) {\n  return new Error(\"You are using a function which must be overwritten by a plugin.\\n        You should either prevent the usage of this function or add the plugin via:\\n          - es5-require:\\n            RxDB.plugin(require('rxdb/plugins/\" + pluginKey + \"'))\\n          - es6-import:\\n            import \" + ucfirst(pluginKey) + \"Plugin from 'rxdb/plugins/\" + pluginKey + \"';\\n            RxDB.plugin(\" + ucfirst(pluginKey) + \"Plugin);\\n        \");\n}\n/**\n * this is a very fast hashing but its unsecure\n * @link http://stackoverflow.com/questions/7616461/generate-a-hash-from-string-in-javascript-jquery\n * @return a number as hash-result\n */\n\nexport function fastUnsecureHash(obj) {\n  if (typeof obj !== 'string') obj = JSON.stringify(obj);\n  var hashValue = 0,\n      i,\n      chr,\n      len;\n  if (obj.length === 0) return hashValue;\n\n  for (i = 0, len = obj.length; i < len; i++) {\n    chr = obj.charCodeAt(i); // tslint:disable-next-line\n\n    hashValue = (hashValue << 5) - hashValue + chr; // tslint:disable-next-line\n\n    hashValue |= 0; // Convert to 32bit integer\n  }\n\n  if (hashValue < 0) hashValue = hashValue * -1;\n  return hashValue;\n}\n/**\n *  spark-md5 is used here\n *  because pouchdb uses the same\n *  and build-size could be reduced by 9kb\n */\n\nimport Md5 from 'spark-md5';\nexport function hash(obj) {\n  var msg = obj;\n  if (typeof obj !== 'string') msg = JSON.stringify(obj);\n  return Md5.hash(msg);\n}\n/**\n * generate a new _id as db-primary-key\n */\n\nexport function generateId() {\n  return randomToken(10) + ':' + new Date().getTime();\n}\n/**\n * returns a promise that resolves on the next tick\n */\n\nexport function nextTick() {\n  return new Promise(function (res) {\n    return setTimeout(res, 0);\n  });\n}\nexport function promiseWait() {\n  var ms = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  return new Promise(function (res) {\n    return setTimeout(res, ms);\n  });\n}\nexport function toPromise(maybePromise) {\n  if (maybePromise && typeof maybePromise.then === 'function') {\n    // is promise\n    return maybePromise;\n  } else {\n    return Promise.resolve(maybePromise);\n  }\n}\nexport function requestIdlePromise() {\n  var timeout = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\n  if (typeof window === 'object' && window['requestIdleCallback']) {\n    return new Promise(function (res) {\n      return window['requestIdleCallback'](res, {\n        timeout: timeout\n      });\n    });\n  } else return Promise.resolve();\n}\n/**\n * like Promise.all() but runs in series instead of parallel\n * @link https://github.com/egoist/promise.series/blob/master/index.js\n * @param tasks array with functions that return a promise\n */\n\nexport function promiseSeries(tasks, initial) {\n  return tasks.reduce(function (current, next) {\n    return current.then(next);\n  }, Promise.resolve(initial));\n}\n/**\n * run the callback if requestIdleCallback available\n * do nothing if not\n * @link https://developer.mozilla.org/de/docs/Web/API/Window/requestIdleCallback\n */\n\nexport function requestIdleCallbackIfAvailable(fun) {\n  if (typeof window === 'object' && window['requestIdleCallback']) window['requestIdleCallback'](fun);\n}\n/**\n * uppercase first char\n */\n\nexport function ucfirst(str) {\n  str += '';\n  var f = str.charAt(0).toUpperCase();\n  return f + str.substr(1);\n}\n/**\n * @link https://de.wikipedia.org/wiki/Base58\n * this does not start with the numbers to generate valid variable-names\n */\n\nvar base58Chars = 'abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ123456789';\nvar base58Length = base58Chars.length;\n/**\n * transform a number to a string by using only base58 chars\n * @link https://github.com/matthewmueller/number-to-letter/blob/master/index.js\n * @param nr                                       | 10000000\n * @return the string-representation of the number | '2oMX'\n */\n\nexport function numberToLetter(nr) {\n  var digits = [];\n\n  do {\n    var v = nr % base58Length;\n    digits.push(v);\n    nr = Math.floor(nr / base58Length);\n  } while (nr-- > 0);\n\n  return digits.reverse().map(function (d) {\n    return base58Chars[d];\n  }).join('');\n}\n/**\n * removes trailing and ending dots from the string\n */\n\nexport function trimDots(str) {\n  // start\n  while (str.charAt(0) === '.') {\n    str = str.substr(1);\n  } // end\n\n\n  while (str.slice(-1) === '.') {\n    str = str.slice(0, -1);\n  }\n\n  return str;\n}\n/**\n * deep-sort an object so its attributes are in lexical order.\n * Also sorts the arrays inside of the object if no-array-sort not set\n */\n\nexport function sortObject(obj) {\n  var noArraySort = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  if (!obj) return obj; // do not sort null, false or undefined\n  // array\n\n  if (!noArraySort && Array.isArray(obj)) {\n    return obj.sort(function (a, b) {\n      if (typeof a === 'string' && typeof b === 'string') return a.localeCompare(b);\n      if (typeof a === 'object') return 1;else return -1;\n    }).map(function (i) {\n      return sortObject(i);\n    });\n  } // object\n\n\n  if (typeof obj === 'object') {\n    if (obj instanceof RegExp) return obj;\n    var out = {};\n    Object.keys(obj).sort(function (a, b) {\n      return a.localeCompare(b);\n    }).forEach(function (key) {\n      out[key] = sortObject(obj[key]);\n    });\n    return out;\n  } // everything else\n\n\n  return obj;\n}\n/**\n * used to JSON.stringify() objects that contain a regex\n * @link https://stackoverflow.com/a/33416684 thank you Fabian Jakobs!\n */\n\nexport function stringifyFilter(key, value) {\n  if (value instanceof RegExp) return value.toString();\n  return value;\n}\n/**\n * get a random string which can be used with couchdb\n * @link http://stackoverflow.com/a/1349426/3443137\n */\n\nexport function randomCouchString() {\n  var length = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 10;\n  var text = '';\n  var possible = 'abcdefghijklmnopqrstuvwxyz';\n\n  for (var i = 0; i < length; i++) {\n    text += possible.charAt(Math.floor(Math.random() * possible.length));\n  }\n\n  return text;\n}\n/**\n * shuffle the given array\n */\n\nexport function shuffleArray(arr) {\n  return arr.sort(function () {\n    return Math.random() - 0.5;\n  });\n}\n/**\n * @link https://stackoverflow.com/a/15996017\n */\n\nexport function removeOneFromArrayIfMatches(ar, condition) {\n  ar = ar.slice();\n  var i = ar.length;\n  var done = false;\n\n  while (i-- && !done) {\n    if (condition(ar[i])) {\n      done = true;\n      ar.splice(i, 1);\n    }\n  }\n\n  return ar;\n}\n/**\n * transforms the given adapter into a pouch-compatible object\n */\n\nexport function adapterObject(adapter) {\n  var adapterObj = {\n    db: adapter\n  };\n\n  if (typeof adapter === 'string') {\n    adapterObj = {\n      adapter: adapter\n    };\n  }\n\n  return adapterObj;\n}\n\nfunction recursiveDeepCopy(o) {\n  if (!o) return o;\n  return deepClone(o, false);\n}\n\nexport var clone = recursiveDeepCopy;\n/**\n * does a flat copy on the objects,\n * is about 3 times faster then using deepClone\n * @link https://jsperf.com/object-rest-spread-vs-clone/2\n */\n\nexport function flatClone(obj) {\n  return Object.assign({}, obj);\n}\nimport isElectron from 'is-electron';\nexport var isElectronRenderer = isElectron();\n/**\n * returns a flattened object\n * @link https://gist.github.com/penguinboy/762197\n */\n\nexport function flattenObject(ob) {\n  var toReturn = {};\n\n  for (var i in ob) {\n    if (!ob.hasOwnProperty(i)) continue;\n\n    if (typeof ob[i] === 'object') {\n      var flatObject = flattenObject(ob[i]);\n\n      for (var _x in flatObject) {\n        if (!flatObject.hasOwnProperty(_x)) continue;\n        toReturn[i + '.' + _x] = flatObject[_x];\n      }\n    } else {\n      toReturn[i] = ob[i];\n    }\n  }\n\n  return toReturn;\n}\nexport function getHeightOfRevision(revString) {\n  var first = revString.split('-')[0];\n  return parseInt(first, 10);\n}\n/**\n * prefix of local documents\n * TODO check if this variable exists somewhere else\n */\n\nexport var LOCAL_PREFIX = '_local/';\n//# sourceMappingURL=util.js.map"]},"metadata":{},"sourceType":"module"}