{"ast":null,"code":"import inherits from 'inherits';\nimport { Set } from 'pouchdb-collections';\nimport argsarray from 'argsarray';\nimport { nextTick } from 'pouchdb-utils';\n\nfunction QueryParseError(message) {\n  this.status = 400;\n  this.name = 'query_parse_error';\n  this.message = message;\n  this.error = true;\n\n  try {\n    Error.captureStackTrace(this, QueryParseError);\n  } catch (e) {}\n}\n\ninherits(QueryParseError, Error);\n\nfunction NotFoundError(message) {\n  this.status = 404;\n  this.name = 'not_found';\n  this.message = message;\n  this.error = true;\n\n  try {\n    Error.captureStackTrace(this, NotFoundError);\n  } catch (e) {}\n}\n\ninherits(NotFoundError, Error);\n\nfunction BuiltInError(message) {\n  this.status = 500;\n  this.name = 'invalid_value';\n  this.message = message;\n  this.error = true;\n\n  try {\n    Error.captureStackTrace(this, BuiltInError);\n  } catch (e) {}\n}\n\ninherits(BuiltInError, Error);\n\nfunction promisedCallback(promise, callback) {\n  if (callback) {\n    promise.then(function (res) {\n      nextTick(function () {\n        callback(null, res);\n      });\n    }, function (reason) {\n      nextTick(function () {\n        callback(reason);\n      });\n    });\n  }\n\n  return promise;\n}\n\nfunction callbackify(fun) {\n  return argsarray(function (args) {\n    var cb = args.pop();\n    var promise = fun.apply(this, args);\n\n    if (typeof cb === 'function') {\n      promisedCallback(promise, cb);\n    }\n\n    return promise;\n  });\n} // Promise finally util similar to Q.finally\n\n\nfunction fin(promise, finalPromiseFactory) {\n  return promise.then(function (res) {\n    return finalPromiseFactory().then(function () {\n      return res;\n    });\n  }, function (reason) {\n    return finalPromiseFactory().then(function () {\n      throw reason;\n    });\n  });\n}\n\nfunction sequentialize(queue, promiseFactory) {\n  return function () {\n    var args = arguments;\n    var that = this;\n    return queue.add(function () {\n      return promiseFactory.apply(that, args);\n    });\n  };\n} // uniq an array of strings, order not guaranteed\n// similar to underscore/lodash _.uniq\n\n\nfunction uniq(arr) {\n  var theSet = new Set(arr);\n  var result = new Array(theSet.size);\n  var index = -1;\n  theSet.forEach(function (value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nfunction mapToKeysArray(map) {\n  var result = new Array(map.size);\n  var index = -1;\n  map.forEach(function (value, key) {\n    result[++index] = key;\n  });\n  return result;\n}\n\nexport { uniq, sequentialize, fin, callbackify, promisedCallback, mapToKeysArray, QueryParseError, NotFoundError, BuiltInError };","map":{"version":3,"sources":["/Users/Hanzalah/Desktop/github/todo-offline/rxdb-hasura-demo/node_modules/pouchdb-mapreduce-utils/lib/index.es.js"],"names":["inherits","Set","argsarray","nextTick","QueryParseError","message","status","name","error","Error","captureStackTrace","e","NotFoundError","BuiltInError","promisedCallback","promise","callback","then","res","reason","callbackify","fun","args","cb","pop","apply","fin","finalPromiseFactory","sequentialize","queue","promiseFactory","arguments","that","add","uniq","arr","theSet","result","Array","size","index","forEach","value","mapToKeysArray","map","key"],"mappings":"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","sourcesContent":["import inherits from 'inherits';\nimport { Set } from 'pouchdb-collections';\nimport argsarray from 'argsarray';\nimport { nextTick } from 'pouchdb-utils';\n\nfunction QueryParseError(message) {\n  this.status = 400;\n  this.name = 'query_parse_error';\n  this.message = message;\n  this.error = true;\n  try {\n    Error.captureStackTrace(this, QueryParseError);\n  } catch (e) {}\n}\n\ninherits(QueryParseError, Error);\n\nfunction NotFoundError(message) {\n  this.status = 404;\n  this.name = 'not_found';\n  this.message = message;\n  this.error = true;\n  try {\n    Error.captureStackTrace(this, NotFoundError);\n  } catch (e) {}\n}\n\ninherits(NotFoundError, Error);\n\nfunction BuiltInError(message) {\n  this.status = 500;\n  this.name = 'invalid_value';\n  this.message = message;\n  this.error = true;\n  try {\n    Error.captureStackTrace(this, BuiltInError);\n  } catch (e) {}\n}\n\ninherits(BuiltInError, Error);\n\nfunction promisedCallback(promise, callback) {\n  if (callback) {\n    promise.then(function (res) {\n      nextTick(function () {\n        callback(null, res);\n      });\n    }, function (reason) {\n      nextTick(function () {\n        callback(reason);\n      });\n    });\n  }\n  return promise;\n}\n\nfunction callbackify(fun) {\n  return argsarray(function (args) {\n    var cb = args.pop();\n    var promise = fun.apply(this, args);\n    if (typeof cb === 'function') {\n      promisedCallback(promise, cb);\n    }\n    return promise;\n  });\n}\n\n// Promise finally util similar to Q.finally\nfunction fin(promise, finalPromiseFactory) {\n  return promise.then(function (res) {\n    return finalPromiseFactory().then(function () {\n      return res;\n    });\n  }, function (reason) {\n    return finalPromiseFactory().then(function () {\n      throw reason;\n    });\n  });\n}\n\nfunction sequentialize(queue, promiseFactory) {\n  return function () {\n    var args = arguments;\n    var that = this;\n    return queue.add(function () {\n      return promiseFactory.apply(that, args);\n    });\n  };\n}\n\n// uniq an array of strings, order not guaranteed\n// similar to underscore/lodash _.uniq\nfunction uniq(arr) {\n  var theSet = new Set(arr);\n  var result = new Array(theSet.size);\n  var index = -1;\n  theSet.forEach(function (value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nfunction mapToKeysArray(map) {\n  var result = new Array(map.size);\n  var index = -1;\n  map.forEach(function (value, key) {\n    result[++index] = key;\n  });\n  return result;\n}\n\nexport { uniq, sequentialize, fin, callbackify, promisedCallback, mapToKeysArray, QueryParseError, NotFoundError, BuiltInError };\n"]},"metadata":{},"sourceType":"module"}