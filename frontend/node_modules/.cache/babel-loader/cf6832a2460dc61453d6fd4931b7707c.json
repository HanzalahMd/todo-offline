{"ast":null,"code":"/**\n * this contains a mapping to basic dependencies\n * which should be easy to change\n */\nimport randomToken from 'random-token';\nimport { default as deepClone } from 'clone';\n/**\n * Returns an error that indicates that a plugin is missing\n * We do not throw a RxError because this should not be handled\n * programmatically but by using the correct import\n */\n\nexport function pluginMissing(pluginKey) {\n  var keyParts = pluginKey.split('-');\n  var pluginName = 'RxDB';\n  keyParts.forEach(function (part) {\n    pluginName += ucfirst(part);\n  });\n  pluginName += 'Plugin';\n  return new Error(\"You are using a function which must be overwritten by a plugin.\\n        You should either prevent the usage of this function or add the plugin via:\\n            import { \" + pluginName + \" } from 'rxdb/plugins/\" + pluginKey + \"';\\n            addRxPlugin(\" + pluginName + \");\\n        \");\n}\n/**\n * this is a very fast hashing but its unsecure\n * @link http://stackoverflow.com/questions/7616461/generate-a-hash-from-string-in-javascript-jquery\n * @return a number as hash-result\n */\n\nexport function fastUnsecureHash(obj) {\n  if (typeof obj !== 'string') obj = JSON.stringify(obj);\n  var hashValue = 0,\n      i,\n      chr,\n      len;\n  if (obj.length === 0) return hashValue;\n\n  for (i = 0, len = obj.length; i < len; i++) {\n    chr = obj.charCodeAt(i); // tslint:disable-next-line\n\n    hashValue = (hashValue << 5) - hashValue + chr; // tslint:disable-next-line\n\n    hashValue |= 0; // Convert to 32bit integer\n  }\n\n  if (hashValue < 0) hashValue = hashValue * -1;\n  return hashValue;\n}\n/**\n * Does a RxDB-specific hashing of the given data.\n * We use a static salt so using a rainbow-table\n * or google-ing the hash will not work.\n *\n * spark-md5 is used here\n * because pouchdb uses the same\n * and build-size could be reduced by 9kb\n */\n\nimport Md5 from 'spark-md5';\nexport var RXDB_HASH_SALT = 'rxdb-specific-hash-salt';\nexport function hash(msg) {\n  if (typeof msg !== 'string') {\n    msg = JSON.stringify(msg);\n  }\n\n  return Md5.hash(RXDB_HASH_SALT + msg);\n}\n/**\n * generate a new _id as db-primary-key\n */\n\nexport function generateId() {\n  return randomToken(10) + ':' + now();\n}\n/**\n * Returns the current unix time in milliseconds\n * Because the accuracy of getTime() in javascript is bad,\n * and we cannot rely on performance.now() on all plattforms,\n * this method implements a way to never return the same value twice.\n * This ensures that when now() is called often, we do not loose the information\n * about which call came first and which came after.\n * Caution: Do not call this too often in a short timespan\n * because it might return 'the future'\n */\n\nvar _lastNow = 0;\nexport function now() {\n  var ret = new Date().getTime();\n\n  if (ret <= _lastNow) {\n    ret = _lastNow + 1;\n  }\n\n  _lastNow = ret;\n  return ret;\n}\n/**\n * returns a promise that resolves on the next tick\n */\n\nexport function nextTick() {\n  return new Promise(function (res) {\n    return setTimeout(res, 0);\n  });\n}\nexport function promiseWait() {\n  var ms = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  return new Promise(function (res) {\n    return setTimeout(res, ms);\n  });\n}\nexport function toPromise(maybePromise) {\n  if (maybePromise && typeof maybePromise.then === 'function') {\n    // is promise\n    return maybePromise;\n  } else {\n    return Promise.resolve(maybePromise);\n  }\n}\nexport function requestIdlePromise() {\n  var timeout = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\n  if (typeof window === 'object' && window['requestIdleCallback']) {\n    return new Promise(function (res) {\n      return window['requestIdleCallback'](res, {\n        timeout: timeout\n      });\n    });\n  } else return Promise.resolve();\n}\n/**\n * like Promise.all() but runs in series instead of parallel\n * @link https://github.com/egoist/promise.series/blob/master/index.js\n * @param tasks array with functions that return a promise\n */\n\nexport function promiseSeries(tasks, initial) {\n  return tasks.reduce(function (current, next) {\n    return current.then(next);\n  }, Promise.resolve(initial));\n}\n/**\n * run the callback if requestIdleCallback available\n * do nothing if not\n * @link https://developer.mozilla.org/de/docs/Web/API/Window/requestIdleCallback\n */\n\nexport function requestIdleCallbackIfAvailable(fun) {\n  if (typeof window === 'object' && window['requestIdleCallback']) window['requestIdleCallback'](fun);\n}\n/**\n * uppercase first char\n */\n\nexport function ucfirst(str) {\n  str += '';\n  var f = str.charAt(0).toUpperCase();\n  return f + str.substr(1);\n}\n/**\n * removes trailing and ending dots from the string\n */\n\nexport function trimDots(str) {\n  // start\n  while (str.charAt(0) === '.') {\n    str = str.substr(1);\n  } // end\n\n\n  while (str.slice(-1) === '.') {\n    str = str.slice(0, -1);\n  }\n\n  return str;\n}\n/**\n * deep-sort an object so its attributes are in lexical order.\n * Also sorts the arrays inside of the object if no-array-sort not set\n */\n\nexport function sortObject(obj) {\n  var noArraySort = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  if (!obj) return obj; // do not sort null, false or undefined\n  // array\n\n  if (!noArraySort && Array.isArray(obj)) {\n    return obj.sort(function (a, b) {\n      if (typeof a === 'string' && typeof b === 'string') return a.localeCompare(b);\n      if (typeof a === 'object') return 1;else return -1;\n    }).map(function (i) {\n      return sortObject(i, noArraySort);\n    });\n  } // object\n  // array is also of type object\n\n\n  if (typeof obj === 'object' && !Array.isArray(obj)) {\n    if (obj instanceof RegExp) return obj;\n    var out = {};\n    Object.keys(obj).sort(function (a, b) {\n      return a.localeCompare(b);\n    }).forEach(function (key) {\n      out[key] = sortObject(obj[key], noArraySort);\n    });\n    return out;\n  } // everything else\n\n\n  return obj;\n}\n/**\n * used to JSON.stringify() objects that contain a regex\n * @link https://stackoverflow.com/a/33416684 thank you Fabian Jakobs!\n */\n\nexport function stringifyFilter(key, value) {\n  if (value instanceof RegExp) return value.toString();\n  return value;\n}\n/**\n * get a random string which can be used with couchdb\n * @link http://stackoverflow.com/a/1349426/3443137\n */\n\nexport function randomCouchString() {\n  var length = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 10;\n  var text = '';\n  var possible = 'abcdefghijklmnopqrstuvwxyz';\n\n  for (var i = 0; i < length; i++) {\n    text += possible.charAt(Math.floor(Math.random() * possible.length));\n  }\n\n  return text;\n}\n/**\n * shuffle the given array\n */\n\nexport function shuffleArray(arr) {\n  return arr.sort(function () {\n    return Math.random() - 0.5;\n  });\n}\n/**\n * @link https://stackoverflow.com/a/15996017\n */\n\nexport function removeOneFromArrayIfMatches(ar, condition) {\n  ar = ar.slice();\n  var i = ar.length;\n  var done = false;\n\n  while (i-- && !done) {\n    if (condition(ar[i])) {\n      done = true;\n      ar.splice(i, 1);\n    }\n  }\n\n  return ar;\n}\n/**\n * transforms the given adapter into a pouch-compatible object\n */\n\nexport function adapterObject(adapter) {\n  var adapterObj = {\n    db: adapter\n  };\n\n  if (typeof adapter === 'string') {\n    adapterObj = {\n      adapter: adapter\n    };\n  }\n\n  return adapterObj;\n}\n\nfunction recursiveDeepCopy(o) {\n  if (!o) return o;\n  return deepClone(o, false);\n}\n\nexport var clone = recursiveDeepCopy;\n/**\n * does a flat copy on the objects,\n * is about 3 times faster then using deepClone\n * @link https://jsperf.com/object-rest-spread-vs-clone/2\n */\n\nexport function flatClone(obj) {\n  return Object.assign({}, obj);\n}\nimport isElectron from 'is-electron';\nexport var isElectronRenderer = isElectron();\n/**\n * returns a flattened object\n * @link https://gist.github.com/penguinboy/762197\n */\n\nexport function flattenObject(ob) {\n  var toReturn = {};\n\n  for (var i in ob) {\n    if (!ob.hasOwnProperty(i)) continue;\n\n    if (typeof ob[i] === 'object') {\n      var flatObject = flattenObject(ob[i]);\n\n      for (var _x in flatObject) {\n        if (!flatObject.hasOwnProperty(_x)) continue;\n        toReturn[i + '.' + _x] = flatObject[_x];\n      }\n    } else {\n      toReturn[i] = ob[i];\n    }\n  }\n\n  return toReturn;\n}\nexport function getHeightOfRevision(revString) {\n  var first = revString.split('-')[0];\n  return parseInt(first, 10);\n}\n/**\n * prefix of local pouchdb documents\n */\n\nexport var LOCAL_PREFIX = '_local/';\n/**\n * overwrites the getter with the actual value\n * Mostly used for caching stuff on the first run\n */\n\nexport function overwriteGetterForCaching(obj, getterName, value) {\n  Object.defineProperty(obj, getterName, {\n    get: function get() {\n      return value;\n    }\n  });\n  return value;\n}\n/**\n * returns true if the given name is likely a folder path\n */\n\nexport function isFolderPath(name) {\n  // do not check, if foldername is given\n  if (name.includes('/') || // unix\n  name.includes('\\\\') // windows\n  ) {\n      return true;\n    } else {\n    return false;\n  }\n}","map":{"version":3,"sources":["/Users/Hanzalah/Desktop/github/todo-offline/rxdb-hasura-demo/node_modules/rxdb/dist/es/util.js"],"names":["randomToken","default","deepClone","pluginMissing","pluginKey","keyParts","split","pluginName","forEach","part","ucfirst","Error","fastUnsecureHash","obj","JSON","stringify","hashValue","i","chr","len","length","charCodeAt","Md5","RXDB_HASH_SALT","hash","msg","generateId","now","_lastNow","ret","Date","getTime","nextTick","Promise","res","setTimeout","promiseWait","ms","arguments","undefined","toPromise","maybePromise","then","resolve","requestIdlePromise","timeout","window","promiseSeries","tasks","initial","reduce","current","next","requestIdleCallbackIfAvailable","fun","str","f","charAt","toUpperCase","substr","trimDots","slice","sortObject","noArraySort","Array","isArray","sort","a","b","localeCompare","map","RegExp","out","Object","keys","key","stringifyFilter","value","toString","randomCouchString","text","possible","Math","floor","random","shuffleArray","arr","removeOneFromArrayIfMatches","ar","condition","done","splice","adapterObject","adapter","adapterObj","db","recursiveDeepCopy","o","clone","flatClone","assign","isElectron","isElectronRenderer","flattenObject","ob","toReturn","hasOwnProperty","flatObject","_x","getHeightOfRevision","revString","first","parseInt","LOCAL_PREFIX","overwriteGetterForCaching","getterName","defineProperty","get","isFolderPath","name","includes"],"mappings":"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","sourcesContent":["/**\n * this contains a mapping to basic dependencies\n * which should be easy to change\n */\nimport randomToken from 'random-token';\nimport { default as deepClone } from 'clone';\n/**\n * Returns an error that indicates that a plugin is missing\n * We do not throw a RxError because this should not be handled\n * programmatically but by using the correct import\n */\n\nexport function pluginMissing(pluginKey) {\n  var keyParts = pluginKey.split('-');\n  var pluginName = 'RxDB';\n  keyParts.forEach(function (part) {\n    pluginName += ucfirst(part);\n  });\n  pluginName += 'Plugin';\n  return new Error(\"You are using a function which must be overwritten by a plugin.\\n        You should either prevent the usage of this function or add the plugin via:\\n            import { \" + pluginName + \" } from 'rxdb/plugins/\" + pluginKey + \"';\\n            addRxPlugin(\" + pluginName + \");\\n        \");\n}\n/**\n * this is a very fast hashing but its unsecure\n * @link http://stackoverflow.com/questions/7616461/generate-a-hash-from-string-in-javascript-jquery\n * @return a number as hash-result\n */\n\nexport function fastUnsecureHash(obj) {\n  if (typeof obj !== 'string') obj = JSON.stringify(obj);\n  var hashValue = 0,\n      i,\n      chr,\n      len;\n  if (obj.length === 0) return hashValue;\n\n  for (i = 0, len = obj.length; i < len; i++) {\n    chr = obj.charCodeAt(i); // tslint:disable-next-line\n\n    hashValue = (hashValue << 5) - hashValue + chr; // tslint:disable-next-line\n\n    hashValue |= 0; // Convert to 32bit integer\n  }\n\n  if (hashValue < 0) hashValue = hashValue * -1;\n  return hashValue;\n}\n/**\n * Does a RxDB-specific hashing of the given data.\n * We use a static salt so using a rainbow-table\n * or google-ing the hash will not work.\n *\n * spark-md5 is used here\n * because pouchdb uses the same\n * and build-size could be reduced by 9kb\n */\n\nimport Md5 from 'spark-md5';\nexport var RXDB_HASH_SALT = 'rxdb-specific-hash-salt';\nexport function hash(msg) {\n  if (typeof msg !== 'string') {\n    msg = JSON.stringify(msg);\n  }\n\n  return Md5.hash(RXDB_HASH_SALT + msg);\n}\n/**\n * generate a new _id as db-primary-key\n */\n\nexport function generateId() {\n  return randomToken(10) + ':' + now();\n}\n/**\n * Returns the current unix time in milliseconds\n * Because the accuracy of getTime() in javascript is bad,\n * and we cannot rely on performance.now() on all plattforms,\n * this method implements a way to never return the same value twice.\n * This ensures that when now() is called often, we do not loose the information\n * about which call came first and which came after.\n * Caution: Do not call this too often in a short timespan\n * because it might return 'the future'\n */\n\nvar _lastNow = 0;\nexport function now() {\n  var ret = new Date().getTime();\n\n  if (ret <= _lastNow) {\n    ret = _lastNow + 1;\n  }\n\n  _lastNow = ret;\n  return ret;\n}\n/**\n * returns a promise that resolves on the next tick\n */\n\nexport function nextTick() {\n  return new Promise(function (res) {\n    return setTimeout(res, 0);\n  });\n}\nexport function promiseWait() {\n  var ms = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  return new Promise(function (res) {\n    return setTimeout(res, ms);\n  });\n}\nexport function toPromise(maybePromise) {\n  if (maybePromise && typeof maybePromise.then === 'function') {\n    // is promise\n    return maybePromise;\n  } else {\n    return Promise.resolve(maybePromise);\n  }\n}\nexport function requestIdlePromise() {\n  var timeout = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\n  if (typeof window === 'object' && window['requestIdleCallback']) {\n    return new Promise(function (res) {\n      return window['requestIdleCallback'](res, {\n        timeout: timeout\n      });\n    });\n  } else return Promise.resolve();\n}\n/**\n * like Promise.all() but runs in series instead of parallel\n * @link https://github.com/egoist/promise.series/blob/master/index.js\n * @param tasks array with functions that return a promise\n */\n\nexport function promiseSeries(tasks, initial) {\n  return tasks.reduce(function (current, next) {\n    return current.then(next);\n  }, Promise.resolve(initial));\n}\n/**\n * run the callback if requestIdleCallback available\n * do nothing if not\n * @link https://developer.mozilla.org/de/docs/Web/API/Window/requestIdleCallback\n */\n\nexport function requestIdleCallbackIfAvailable(fun) {\n  if (typeof window === 'object' && window['requestIdleCallback']) window['requestIdleCallback'](fun);\n}\n/**\n * uppercase first char\n */\n\nexport function ucfirst(str) {\n  str += '';\n  var f = str.charAt(0).toUpperCase();\n  return f + str.substr(1);\n}\n/**\n * removes trailing and ending dots from the string\n */\n\nexport function trimDots(str) {\n  // start\n  while (str.charAt(0) === '.') {\n    str = str.substr(1);\n  } // end\n\n\n  while (str.slice(-1) === '.') {\n    str = str.slice(0, -1);\n  }\n\n  return str;\n}\n/**\n * deep-sort an object so its attributes are in lexical order.\n * Also sorts the arrays inside of the object if no-array-sort not set\n */\n\nexport function sortObject(obj) {\n  var noArraySort = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  if (!obj) return obj; // do not sort null, false or undefined\n  // array\n\n  if (!noArraySort && Array.isArray(obj)) {\n    return obj.sort(function (a, b) {\n      if (typeof a === 'string' && typeof b === 'string') return a.localeCompare(b);\n      if (typeof a === 'object') return 1;else return -1;\n    }).map(function (i) {\n      return sortObject(i, noArraySort);\n    });\n  } // object\n  // array is also of type object\n\n\n  if (typeof obj === 'object' && !Array.isArray(obj)) {\n    if (obj instanceof RegExp) return obj;\n    var out = {};\n    Object.keys(obj).sort(function (a, b) {\n      return a.localeCompare(b);\n    }).forEach(function (key) {\n      out[key] = sortObject(obj[key], noArraySort);\n    });\n    return out;\n  } // everything else\n\n\n  return obj;\n}\n/**\n * used to JSON.stringify() objects that contain a regex\n * @link https://stackoverflow.com/a/33416684 thank you Fabian Jakobs!\n */\n\nexport function stringifyFilter(key, value) {\n  if (value instanceof RegExp) return value.toString();\n  return value;\n}\n/**\n * get a random string which can be used with couchdb\n * @link http://stackoverflow.com/a/1349426/3443137\n */\n\nexport function randomCouchString() {\n  var length = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 10;\n  var text = '';\n  var possible = 'abcdefghijklmnopqrstuvwxyz';\n\n  for (var i = 0; i < length; i++) {\n    text += possible.charAt(Math.floor(Math.random() * possible.length));\n  }\n\n  return text;\n}\n/**\n * shuffle the given array\n */\n\nexport function shuffleArray(arr) {\n  return arr.sort(function () {\n    return Math.random() - 0.5;\n  });\n}\n/**\n * @link https://stackoverflow.com/a/15996017\n */\n\nexport function removeOneFromArrayIfMatches(ar, condition) {\n  ar = ar.slice();\n  var i = ar.length;\n  var done = false;\n\n  while (i-- && !done) {\n    if (condition(ar[i])) {\n      done = true;\n      ar.splice(i, 1);\n    }\n  }\n\n  return ar;\n}\n/**\n * transforms the given adapter into a pouch-compatible object\n */\n\nexport function adapterObject(adapter) {\n  var adapterObj = {\n    db: adapter\n  };\n\n  if (typeof adapter === 'string') {\n    adapterObj = {\n      adapter: adapter\n    };\n  }\n\n  return adapterObj;\n}\n\nfunction recursiveDeepCopy(o) {\n  if (!o) return o;\n  return deepClone(o, false);\n}\n\nexport var clone = recursiveDeepCopy;\n/**\n * does a flat copy on the objects,\n * is about 3 times faster then using deepClone\n * @link https://jsperf.com/object-rest-spread-vs-clone/2\n */\n\nexport function flatClone(obj) {\n  return Object.assign({}, obj);\n}\nimport isElectron from 'is-electron';\nexport var isElectronRenderer = isElectron();\n/**\n * returns a flattened object\n * @link https://gist.github.com/penguinboy/762197\n */\n\nexport function flattenObject(ob) {\n  var toReturn = {};\n\n  for (var i in ob) {\n    if (!ob.hasOwnProperty(i)) continue;\n\n    if (typeof ob[i] === 'object') {\n      var flatObject = flattenObject(ob[i]);\n\n      for (var _x in flatObject) {\n        if (!flatObject.hasOwnProperty(_x)) continue;\n        toReturn[i + '.' + _x] = flatObject[_x];\n      }\n    } else {\n      toReturn[i] = ob[i];\n    }\n  }\n\n  return toReturn;\n}\nexport function getHeightOfRevision(revString) {\n  var first = revString.split('-')[0];\n  return parseInt(first, 10);\n}\n/**\n * prefix of local pouchdb documents\n */\n\nexport var LOCAL_PREFIX = '_local/';\n/**\n * overwrites the getter with the actual value\n * Mostly used for caching stuff on the first run\n */\n\nexport function overwriteGetterForCaching(obj, getterName, value) {\n  Object.defineProperty(obj, getterName, {\n    get: function get() {\n      return value;\n    }\n  });\n  return value;\n}\n/**\n * returns true if the given name is likely a folder path\n */\n\nexport function isFolderPath(name) {\n  // do not check, if foldername is given\n  if (name.includes('/') || // unix\n  name.includes('\\\\') // windows\n  ) {\n      return true;\n    } else {\n    return false;\n  }\n}\n//# sourceMappingURL=util.js.map"]},"metadata":{},"sourceType":"module"}