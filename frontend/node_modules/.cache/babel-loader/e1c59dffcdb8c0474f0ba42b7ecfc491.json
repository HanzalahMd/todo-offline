{"ast":null,"code":"var genobj = require('generate-object-property');\n\nvar genfun = require('generate-function');\n\nvar jsonpointer = require('jsonpointer');\n\nvar xtend = require('xtend');\n\nvar formats = require('./formats');\n\nvar get = function get(obj, additionalSchemas, ptr) {\n  var visit = function visit(sub) {\n    if (sub && sub.id === ptr) return sub;\n    if (typeof sub !== 'object' || !sub) return null;\n    return Object.keys(sub).reduce(function (res, k) {\n      return res || visit(sub[k]);\n    }, null);\n  };\n\n  var res = visit(obj);\n  if (res) return res;\n  ptr = ptr.replace(/^#/, '');\n  ptr = ptr.replace(/\\/$/, '');\n\n  try {\n    return jsonpointer.get(obj, decodeURI(ptr));\n  } catch (err) {\n    var end = ptr.indexOf('#');\n    var other; // external reference\n\n    if (end !== 0) {\n      // fragment doesn't exist.\n      if (end === -1) {\n        other = additionalSchemas[ptr];\n      } else {\n        var ext = ptr.slice(0, end);\n        other = additionalSchemas[ext];\n        var fragment = ptr.slice(end).replace(/^#/, '');\n\n        try {\n          return jsonpointer.get(other, fragment);\n        } catch (err) {}\n      }\n    } else {\n      other = additionalSchemas[ptr];\n    }\n\n    return other || null;\n  }\n};\n\nvar formatName = function formatName(field) {\n  field = JSON.stringify(field);\n  var pattern = /\\[([^\\[\\]\"]+)\\]/;\n\n  while (pattern.test(field)) {\n    field = field.replace(pattern, '.\"+$1+\"');\n  }\n\n  return field;\n};\n\nvar types = {};\n\ntypes.any = function () {\n  return 'true';\n};\n\ntypes.null = function (name) {\n  return name + ' === null';\n};\n\ntypes.boolean = function (name) {\n  return 'typeof ' + name + ' === \"boolean\"';\n};\n\ntypes.array = function (name) {\n  return 'Array.isArray(' + name + ')';\n};\n\ntypes.object = function (name) {\n  return 'typeof ' + name + ' === \"object\" && ' + name + ' && !Array.isArray(' + name + ')';\n};\n\ntypes.number = function (name) {\n  return 'typeof ' + name + ' === \"number\" && isFinite(' + name + ')';\n};\n\ntypes.integer = function (name) {\n  return 'typeof ' + name + ' === \"number\" && (Math.floor(' + name + ') === ' + name + ' || ' + name + ' > 9007199254740992 || ' + name + ' < -9007199254740992)';\n};\n\ntypes.string = function (name) {\n  return 'typeof ' + name + ' === \"string\"';\n};\n\nvar unique = function unique(array) {\n  var list = [];\n\n  for (var i = 0; i < array.length; i++) {\n    list.push(typeof array[i] === 'object' ? JSON.stringify(array[i]) : array[i]);\n  }\n\n  for (var i = 1; i < list.length; i++) {\n    if (list.indexOf(list[i]) !== i) return false;\n  }\n\n  return true;\n};\n\nvar isMultipleOf = function isMultipleOf(name, multipleOf) {\n  var res;\n  var factor = (multipleOf | 0) !== multipleOf ? Math.pow(10, multipleOf.toString().split('.').pop().length) : 1;\n\n  if (factor > 1) {\n    var factorName = (name | 0) !== name ? Math.pow(10, name.toString().split('.').pop().length) : 1;\n    if (factorName > factor) res = true;else res = Math.round(factor * name) % (factor * multipleOf);\n  } else res = name % multipleOf;\n\n  return !res;\n};\n\nvar compile = function compile(schema, cache, root, reporter, opts) {\n  var fmts = opts ? xtend(formats, opts.formats) : formats;\n  var scope = {\n    unique: unique,\n    formats: fmts,\n    isMultipleOf: isMultipleOf\n  };\n  var verbose = opts ? !!opts.verbose : false;\n  var greedy = opts && opts.greedy !== undefined ? opts.greedy : false;\n  var syms = {};\n\n  var gensym = function gensym(name) {\n    return name + (syms[name] = (syms[name] || 0) + 1);\n  };\n\n  var reversePatterns = {};\n\n  var patterns = function patterns(p) {\n    if (reversePatterns[p]) return reversePatterns[p];\n    var n = gensym('pattern');\n    scope[n] = new RegExp(p);\n    reversePatterns[p] = n;\n    return n;\n  };\n\n  var vars = ['i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'x', 'y', 'z'];\n\n  var genloop = function genloop() {\n    var v = vars.shift();\n    vars.push(v + v[0]);\n    return v;\n  };\n\n  var visit = function visit(name, node, reporter, filter, schemaPath) {\n    var properties = node.properties;\n    var type = node.type;\n    var tuple = false;\n\n    if (Array.isArray(node.items)) {\n      // tuple type\n      properties = {};\n      node.items.forEach(function (item, i) {\n        properties[i] = item;\n      });\n      type = 'array';\n      tuple = true;\n    }\n\n    var indent = 0;\n\n    var error = function error(msg, prop, value) {\n      validate('errors++');\n\n      if (reporter === true) {\n        validate('if (validate.errors === null) validate.errors = []');\n\n        if (verbose) {\n          validate('validate.errors.push({field:%s,message:%s,value:%s,type:%s,schemaPath:%s})', formatName(prop || name), JSON.stringify(msg), value || name, JSON.stringify(type), JSON.stringify(schemaPath));\n        } else {\n          validate('validate.errors.push({field:%s,message:%s})', formatName(prop || name), JSON.stringify(msg));\n        }\n      }\n    };\n\n    if (node.required === true) {\n      indent++;\n      validate('if (%s === undefined) {', name);\n      error('is required');\n      validate('} else {');\n    } else {\n      indent++;\n      validate('if (%s !== undefined) {', name);\n    }\n\n    var valid = [].concat(type).map(function (t) {\n      if (t && !types.hasOwnProperty(t)) {\n        throw new Error('Unknown type: ' + t);\n      }\n\n      return types[t || 'any'](name);\n    }).join(' || ') || 'true';\n\n    if (valid !== 'true') {\n      indent++;\n      validate('if (!(%s)) {', valid);\n      error('is the wrong type');\n      validate('} else {');\n    }\n\n    if (tuple) {\n      if (node.additionalItems === false) {\n        validate('if (%s.length > %d) {', name, node.items.length);\n        error('has additional items');\n        validate('}');\n      } else if (node.additionalItems) {\n        var i = genloop();\n        validate('for (var %s = %d; %s < %s.length; %s++) {', i, node.items.length, i, name, i);\n        visit(name + '[' + i + ']', node.additionalItems, reporter, filter, schemaPath.concat('additionalItems'));\n        validate('}');\n      }\n    }\n\n    if (node.format && fmts[node.format]) {\n      if (type !== 'string' && formats[node.format]) validate('if (%s) {', types.string(name));\n      var n = gensym('format');\n      scope[n] = fmts[node.format];\n      if (typeof scope[n] === 'function') validate('if (!%s(%s)) {', n, name);else validate('if (!%s.test(%s)) {', n, name);\n      error('must be ' + node.format + ' format');\n      validate('}');\n      if (type !== 'string' && formats[node.format]) validate('}');\n    }\n\n    if (Array.isArray(node.required)) {\n      var checkRequired = function checkRequired(req) {\n        var prop = genobj(name, req);\n        validate('if (%s === undefined) {', prop);\n        error('is required', prop);\n        validate('missing++');\n        validate('}');\n      };\n\n      validate('if ((%s)) {', type !== 'object' ? types.object(name) : 'true');\n      validate('var missing = 0');\n      node.required.map(checkRequired);\n      validate('}');\n\n      if (!greedy) {\n        validate('if (missing === 0) {');\n        indent++;\n      }\n    }\n\n    if (node.uniqueItems) {\n      if (type !== 'array') validate('if (%s) {', types.array(name));\n      validate('if (!(unique(%s))) {', name);\n      error('must be unique');\n      validate('}');\n      if (type !== 'array') validate('}');\n    }\n\n    if (node.enum) {\n      var complex = node.enum.some(function (e) {\n        return typeof e === 'object';\n      });\n      var compare = complex ? function (e) {\n        return 'JSON.stringify(' + name + ')' + ' !== JSON.stringify(' + JSON.stringify(e) + ')';\n      } : function (e) {\n        return name + ' !== ' + JSON.stringify(e);\n      };\n      validate('if (%s) {', node.enum.map(compare).join(' && ') || 'false');\n      error('must be an enum value');\n      validate('}');\n    }\n\n    if (node.dependencies) {\n      if (type !== 'object') validate('if (%s) {', types.object(name));\n      Object.keys(node.dependencies).forEach(function (key) {\n        var deps = node.dependencies[key];\n        if (typeof deps === 'string') deps = [deps];\n\n        var exists = function exists(k) {\n          return genobj(name, k) + ' !== undefined';\n        };\n\n        if (Array.isArray(deps)) {\n          validate('if (%s !== undefined && !(%s)) {', genobj(name, key), deps.map(exists).join(' && ') || 'true');\n          error('dependencies not set');\n          validate('}');\n        }\n\n        if (typeof deps === 'object') {\n          validate('if (%s !== undefined) {', genobj(name, key));\n          visit(name, deps, reporter, filter, schemaPath.concat(['dependencies', key]));\n          validate('}');\n        }\n      });\n      if (type !== 'object') validate('}');\n    }\n\n    if (node.additionalProperties || node.additionalProperties === false) {\n      if (type !== 'object') validate('if (%s) {', types.object(name));\n      var i = genloop();\n      var keys = gensym('keys');\n\n      var toCompare = function toCompare(p) {\n        return keys + '[' + i + '] !== ' + JSON.stringify(p);\n      };\n\n      var toTest = function toTest(p) {\n        return '!' + patterns(p) + '.test(' + keys + '[' + i + '])';\n      };\n\n      var additionalProp = Object.keys(properties || {}).map(toCompare).concat(Object.keys(node.patternProperties || {}).map(toTest)).join(' && ') || 'true';\n      validate('var %s = Object.keys(%s)', keys, name)('for (var %s = 0; %s < %s.length; %s++) {', i, i, keys, i)('if (%s) {', additionalProp);\n\n      if (node.additionalProperties === false) {\n        if (filter) validate('delete %s', name + '[' + keys + '[' + i + ']]');\n        error('has additional properties', null, JSON.stringify(name + '.') + ' + ' + keys + '[' + i + ']');\n      } else {\n        visit(name + '[' + keys + '[' + i + ']]', node.additionalProperties, reporter, filter, schemaPath.concat(['additionalProperties']));\n      }\n\n      validate('}')('}');\n      if (type !== 'object') validate('}');\n    }\n\n    if (node.$ref) {\n      var sub = get(root, opts && opts.schemas || {}, node.$ref);\n\n      if (sub) {\n        var fn = cache[node.$ref];\n\n        if (!fn) {\n          cache[node.$ref] = function proxy(data) {\n            return fn(data);\n          };\n\n          fn = compile(sub, cache, root, false, opts);\n        }\n\n        var n = gensym('ref');\n        scope[n] = fn;\n        validate('if (!(%s(%s))) {', n, name);\n        error('referenced schema does not match');\n        validate('}');\n      }\n    }\n\n    if (node.not) {\n      var prev = gensym('prev');\n      validate('var %s = errors', prev);\n      visit(name, node.not, false, filter, schemaPath.concat('not'));\n      validate('if (%s === errors) {', prev);\n      error('negative schema matches');\n      validate('} else {')('errors = %s', prev)('}');\n    }\n\n    if (node.items && !tuple) {\n      if (type !== 'array') validate('if (%s) {', types.array(name));\n      var i = genloop();\n      validate('for (var %s = 0; %s < %s.length; %s++) {', i, i, name, i);\n      visit(name + '[' + i + ']', node.items, reporter, filter, schemaPath.concat('items'));\n      validate('}');\n      if (type !== 'array') validate('}');\n    }\n\n    if (node.patternProperties) {\n      if (type !== 'object') validate('if (%s) {', types.object(name));\n      var keys = gensym('keys');\n      var i = genloop();\n      validate('var %s = Object.keys(%s)', keys, name)('for (var %s = 0; %s < %s.length; %s++) {', i, i, keys, i);\n      Object.keys(node.patternProperties).forEach(function (key) {\n        var p = patterns(key);\n        validate('if (%s.test(%s)) {', p, keys + '[' + i + ']');\n        visit(name + '[' + keys + '[' + i + ']]', node.patternProperties[key], reporter, filter, schemaPath.concat(['patternProperties', key]));\n        validate('}');\n      });\n      validate('}');\n      if (type !== 'object') validate('}');\n    }\n\n    if (node.pattern) {\n      var p = patterns(node.pattern);\n      if (type !== 'string') validate('if (%s) {', types.string(name));\n      validate('if (!(%s.test(%s))) {', p, name);\n      error('pattern mismatch');\n      validate('}');\n      if (type !== 'string') validate('}');\n    }\n\n    if (node.allOf) {\n      node.allOf.forEach(function (sch, key) {\n        visit(name, sch, reporter, filter, schemaPath.concat(['allOf', key]));\n      });\n    }\n\n    if (node.anyOf && node.anyOf.length) {\n      var prev = gensym('prev');\n      node.anyOf.forEach(function (sch, i) {\n        if (i === 0) {\n          validate('var %s = errors', prev);\n        } else {\n          validate('if (errors !== %s) {', prev)('errors = %s', prev);\n        }\n\n        visit(name, sch, false, false, schemaPath);\n      });\n      node.anyOf.forEach(function (sch, i) {\n        if (i) validate('}');\n      });\n      validate('if (%s !== errors) {', prev);\n      error('no schemas match');\n      validate('}');\n    }\n\n    if (node.oneOf && node.oneOf.length) {\n      var prev = gensym('prev');\n      var passes = gensym('passes');\n      validate('var %s = errors', prev)('var %s = 0', passes);\n      node.oneOf.forEach(function (sch, i) {\n        visit(name, sch, false, false, schemaPath);\n        validate('if (%s === errors) {', prev)('%s++', passes)('} else {')('errors = %s', prev)('}');\n      });\n      validate('if (%s !== 1) {', passes);\n      error('no (or more than one) schemas match');\n      validate('}');\n    }\n\n    if (node.multipleOf !== undefined) {\n      if (type !== 'number' && type !== 'integer') validate('if (%s) {', types.number(name));\n      validate('if (!isMultipleOf(%s, %d)) {', name, node.multipleOf);\n      error('has a remainder');\n      validate('}');\n      if (type !== 'number' && type !== 'integer') validate('}');\n    }\n\n    if (node.maxProperties !== undefined) {\n      if (type !== 'object') validate('if (%s) {', types.object(name));\n      validate('if (Object.keys(%s).length > %d) {', name, node.maxProperties);\n      error('has more properties than allowed');\n      validate('}');\n      if (type !== 'object') validate('}');\n    }\n\n    if (node.minProperties !== undefined) {\n      if (type !== 'object') validate('if (%s) {', types.object(name));\n      validate('if (Object.keys(%s).length < %d) {', name, node.minProperties);\n      error('has less properties than allowed');\n      validate('}');\n      if (type !== 'object') validate('}');\n    }\n\n    if (node.maxItems !== undefined) {\n      if (type !== 'array') validate('if (%s) {', types.array(name));\n      validate('if (%s.length > %d) {', name, node.maxItems);\n      error('has more items than allowed');\n      validate('}');\n      if (type !== 'array') validate('}');\n    }\n\n    if (node.minItems !== undefined) {\n      if (type !== 'array') validate('if (%s) {', types.array(name));\n      validate('if (%s.length < %d) {', name, node.minItems);\n      error('has less items than allowed');\n      validate('}');\n      if (type !== 'array') validate('}');\n    }\n\n    if (node.maxLength !== undefined) {\n      if (type !== 'string') validate('if (%s) {', types.string(name));\n      validate('if (%s.length > %d) {', name, node.maxLength);\n      error('has longer length than allowed');\n      validate('}');\n      if (type !== 'string') validate('}');\n    }\n\n    if (node.minLength !== undefined) {\n      if (type !== 'string') validate('if (%s) {', types.string(name));\n      validate('if (%s.length < %d) {', name, node.minLength);\n      error('has less length than allowed');\n      validate('}');\n      if (type !== 'string') validate('}');\n    }\n\n    if (node.minimum !== undefined) {\n      if (type !== 'number' && type !== 'integer') validate('if (%s) {', types.number(name));\n      validate('if (%s %s %d) {', name, node.exclusiveMinimum ? '<=' : '<', node.minimum);\n      error('is less than minimum');\n      validate('}');\n      if (type !== 'number' && type !== 'integer') validate('}');\n    }\n\n    if (node.maximum !== undefined) {\n      if (type !== 'number' && type !== 'integer') validate('if (%s) {', types.number(name));\n      validate('if (%s %s %d) {', name, node.exclusiveMaximum ? '>=' : '>', node.maximum);\n      error('is more than maximum');\n      validate('}');\n      if (type !== 'number' && type !== 'integer') validate('}');\n    }\n\n    if (properties) {\n      Object.keys(properties).forEach(function (p) {\n        if (Array.isArray(type) && type.indexOf('null') !== -1) validate('if (%s !== null) {', name);\n        visit(genobj(name, p), properties[p], reporter, filter, schemaPath.concat(tuple ? p : ['properties', p]));\n        if (Array.isArray(type) && type.indexOf('null') !== -1) validate('}');\n      });\n    }\n\n    while (indent--) {\n      validate('}');\n    }\n  };\n\n  var validate = genfun('function validate(data) {') // Since undefined is not a valid JSON value, we coerce to null and other checks will catch this\n  ('if (data === undefined) data = null')('validate.errors = null')('var errors = 0');\n  visit('data', schema, reporter, opts && opts.filter, []);\n  validate('return errors === 0')('}');\n  validate = validate.toFunction(scope);\n  validate.errors = null;\n\n  if (Object.defineProperty) {\n    Object.defineProperty(validate, 'error', {\n      get: function get() {\n        if (!validate.errors) return '';\n        return validate.errors.map(function (err) {\n          return err.field + ' ' + err.message;\n        }).join('\\n');\n      }\n    });\n  }\n\n  validate.toJSON = function () {\n    return schema;\n  };\n\n  return validate;\n};\n\nmodule.exports = function (schema, opts) {\n  if (typeof schema === 'string') schema = JSON.parse(schema);\n  return compile(schema, {}, schema, true, opts);\n};\n\nmodule.exports.filter = function (schema, opts) {\n  var validate = module.exports(schema, xtend(opts, {\n    filter: true\n  }));\n  return function (sch) {\n    validate(sch);\n    return sch;\n  };\n};","map":{"version":3,"sources":["/Users/Hanzalah/Desktop/github/todo-offline/rxdb-hasura-demo/node_modules/is-my-json-valid/index.js"],"names":["genobj","require","genfun","jsonpointer","xtend","formats","get","obj","additionalSchemas","ptr","visit","sub","id","Object","keys","reduce","res","k","replace","decodeURI","err","end","indexOf","other","ext","slice","fragment","formatName","field","JSON","stringify","pattern","test","types","any","null","name","boolean","array","object","number","integer","string","unique","list","i","length","push","isMultipleOf","multipleOf","factor","Math","pow","toString","split","pop","factorName","round","compile","schema","cache","root","reporter","opts","fmts","scope","verbose","greedy","undefined","syms","gensym","reversePatterns","patterns","p","n","RegExp","vars","genloop","v","shift","node","filter","schemaPath","properties","type","tuple","Array","isArray","items","forEach","item","indent","error","msg","prop","value","validate","required","valid","concat","map","t","hasOwnProperty","Error","join","additionalItems","format","checkRequired","req","uniqueItems","enum","complex","some","e","compare","dependencies","key","deps","exists","additionalProperties","toCompare","toTest","additionalProp","patternProperties","$ref","schemas","fn","proxy","data","not","prev","allOf","sch","anyOf","oneOf","passes","maxProperties","minProperties","maxItems","minItems","maxLength","minLength","minimum","exclusiveMinimum","maximum","exclusiveMaximum","toFunction","errors","defineProperty","message","toJSON","module","exports","parse"],"mappings":"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","sourcesContent":["var genobj = require('generate-object-property')\nvar genfun = require('generate-function')\nvar jsonpointer = require('jsonpointer')\nvar xtend = require('xtend')\nvar formats = require('./formats')\n\nvar get = function(obj, additionalSchemas, ptr) {\n\n  var visit = function(sub) {\n    if (sub && sub.id === ptr) return sub\n    if (typeof sub !== 'object' || !sub) return null\n    return Object.keys(sub).reduce(function(res, k) {\n      return res || visit(sub[k])\n    }, null)\n  }\n\n  var res = visit(obj)\n  if (res) return res\n\n  ptr = ptr.replace(/^#/, '')\n  ptr = ptr.replace(/\\/$/, '')\n\n  try {\n    return jsonpointer.get(obj, decodeURI(ptr))\n  } catch (err) {\n    var end = ptr.indexOf('#')\n    var other\n    // external reference\n    if (end !== 0) {\n      // fragment doesn't exist.\n      if (end === -1) {\n        other = additionalSchemas[ptr]\n      } else {\n        var ext = ptr.slice(0, end)\n        other = additionalSchemas[ext]\n        var fragment = ptr.slice(end).replace(/^#/, '')\n        try {\n          return jsonpointer.get(other, fragment)\n        } catch (err) {}\n      }\n    } else {\n      other = additionalSchemas[ptr]\n    }\n    return other || null\n  }\n}\n\nvar formatName = function(field) {\n  field = JSON.stringify(field)\n  var pattern = /\\[([^\\[\\]\"]+)\\]/\n  while (pattern.test(field)) field = field.replace(pattern, '.\"+$1+\"')\n  return field\n}\n\nvar types = {}\n\ntypes.any = function() {\n  return 'true'\n}\n\ntypes.null = function(name) {\n  return name+' === null'\n}\n\ntypes.boolean = function(name) {\n  return 'typeof '+name+' === \"boolean\"'\n}\n\ntypes.array = function(name) {\n  return 'Array.isArray('+name+')'\n}\n\ntypes.object = function(name) {\n  return 'typeof '+name+' === \"object\" && '+name+' && !Array.isArray('+name+')'\n}\n\ntypes.number = function(name) {\n  return 'typeof '+name+' === \"number\" && isFinite('+name+')'\n}\n\ntypes.integer = function(name) {\n  return 'typeof '+name+' === \"number\" && (Math.floor('+name+') === '+name+' || '+name+' > 9007199254740992 || '+name+' < -9007199254740992)'\n}\n\ntypes.string = function(name) {\n  return 'typeof '+name+' === \"string\"'\n}\n\nvar unique = function(array) {\n  var list = []\n  for (var i = 0; i < array.length; i++) {\n    list.push(typeof array[i] === 'object' ? JSON.stringify(array[i]) : array[i])\n  }\n  for (var i = 1; i < list.length; i++) {\n    if (list.indexOf(list[i]) !== i) return false\n  }\n  return true\n}\n\nvar isMultipleOf = function(name, multipleOf) {\n  var res;\n  var factor = ((multipleOf | 0) !== multipleOf) ? Math.pow(10, multipleOf.toString().split('.').pop().length) : 1\n  if (factor > 1) {\n    var factorName = ((name | 0) !== name) ? Math.pow(10, name.toString().split('.').pop().length) : 1\n    if (factorName > factor) res = true\n    else res = Math.round(factor * name) % (factor * multipleOf)\n  }\n  else res = name % multipleOf;\n  return !res;\n}\n\nvar compile = function(schema, cache, root, reporter, opts) {\n  var fmts = opts ? xtend(formats, opts.formats) : formats\n  var scope = {unique:unique, formats:fmts, isMultipleOf:isMultipleOf}\n  var verbose = opts ? !!opts.verbose : false;\n  var greedy = opts && opts.greedy !== undefined ?\n    opts.greedy : false;\n\n  var syms = {}\n  var gensym = function(name) {\n    return name+(syms[name] = (syms[name] || 0)+1)\n  }\n\n  var reversePatterns = {}\n  var patterns = function(p) {\n    if (reversePatterns[p]) return reversePatterns[p]\n    var n = gensym('pattern')\n    scope[n] = new RegExp(p)\n    reversePatterns[p] = n\n    return n\n  }\n\n  var vars = ['i','j','k','l','m','n','o','p','q','r','s','t','u','v','x','y','z']\n  var genloop = function() {\n    var v = vars.shift()\n    vars.push(v+v[0])\n    return v\n  }\n\n  var visit = function(name, node, reporter, filter, schemaPath) {\n    var properties = node.properties\n    var type = node.type\n    var tuple = false\n\n    if (Array.isArray(node.items)) { // tuple type\n      properties = {}\n      node.items.forEach(function(item, i) {\n        properties[i] = item\n      })\n      type = 'array'\n      tuple = true\n    }\n\n    var indent = 0\n    var error = function(msg, prop, value) {\n      validate('errors++')\n      if (reporter === true) {\n        validate('if (validate.errors === null) validate.errors = []')\n        if (verbose) {\n          validate(\n            'validate.errors.push({field:%s,message:%s,value:%s,type:%s,schemaPath:%s})',\n            formatName(prop || name),\n            JSON.stringify(msg),\n            value || name,\n            JSON.stringify(type),\n            JSON.stringify(schemaPath)\n          )\n        } else {\n          validate('validate.errors.push({field:%s,message:%s})', formatName(prop || name), JSON.stringify(msg))\n        }\n      }\n    }\n\n    if (node.required === true) {\n      indent++\n      validate('if (%s === undefined) {', name)\n      error('is required')\n      validate('} else {')\n    } else {\n      indent++\n      validate('if (%s !== undefined) {', name)\n    }\n\n    var valid = [].concat(type)\n      .map(function(t) {\n        if (t && !types.hasOwnProperty(t)) {\n          throw new Error('Unknown type: ' + t)\n        }\n\n        return types[t || 'any'](name)\n      })\n      .join(' || ') || 'true'\n\n    if (valid !== 'true') {\n      indent++\n      validate('if (!(%s)) {', valid)\n      error('is the wrong type')\n      validate('} else {')\n    }\n\n    if (tuple) {\n      if (node.additionalItems === false) {\n        validate('if (%s.length > %d) {', name, node.items.length)\n        error('has additional items')\n        validate('}')\n      } else if (node.additionalItems) {\n        var i = genloop()\n        validate('for (var %s = %d; %s < %s.length; %s++) {', i, node.items.length, i, name, i)\n        visit(name+'['+i+']', node.additionalItems, reporter, filter, schemaPath.concat('additionalItems'))\n        validate('}')\n      }\n    }\n\n    if (node.format && fmts[node.format]) {\n      if (type !== 'string' && formats[node.format]) validate('if (%s) {', types.string(name))\n      var n = gensym('format')\n      scope[n] = fmts[node.format]\n\n      if (typeof scope[n] === 'function') validate('if (!%s(%s)) {', n, name)\n      else validate('if (!%s.test(%s)) {', n, name)\n      error('must be '+node.format+' format')\n      validate('}')\n      if (type !== 'string' && formats[node.format]) validate('}')\n    }\n\n    if (Array.isArray(node.required)) {\n      var checkRequired = function (req) {\n        var prop = genobj(name, req);\n        validate('if (%s === undefined) {', prop)\n        error('is required', prop)\n        validate('missing++')\n        validate('}')\n      }\n      validate('if ((%s)) {', type !== 'object' ? types.object(name) : 'true')\n      validate('var missing = 0')\n      node.required.map(checkRequired)\n      validate('}');\n      if (!greedy) {\n        validate('if (missing === 0) {')\n        indent++\n      }\n    }\n\n    if (node.uniqueItems) {\n      if (type !== 'array') validate('if (%s) {', types.array(name))\n      validate('if (!(unique(%s))) {', name)\n      error('must be unique')\n      validate('}')\n      if (type !== 'array') validate('}')\n    }\n\n    if (node.enum) {\n      var complex = node.enum.some(function(e) {\n        return typeof e === 'object'\n      })\n\n      var compare = complex ?\n        function(e) {\n          return 'JSON.stringify('+name+')'+' !== JSON.stringify('+JSON.stringify(e)+')'\n        } :\n        function(e) {\n          return name+' !== '+JSON.stringify(e)\n        }\n\n      validate('if (%s) {', node.enum.map(compare).join(' && ') || 'false')\n      error('must be an enum value')\n      validate('}')\n    }\n\n    if (node.dependencies) {\n      if (type !== 'object') validate('if (%s) {', types.object(name))\n\n      Object.keys(node.dependencies).forEach(function(key) {\n        var deps = node.dependencies[key]\n        if (typeof deps === 'string') deps = [deps]\n\n        var exists = function(k) {\n          return genobj(name, k) + ' !== undefined'\n        }\n\n        if (Array.isArray(deps)) {\n          validate('if (%s !== undefined && !(%s)) {', genobj(name, key), deps.map(exists).join(' && ') || 'true')\n          error('dependencies not set')\n          validate('}')\n        }\n        if (typeof deps === 'object') {\n          validate('if (%s !== undefined) {', genobj(name, key))\n          visit(name, deps, reporter, filter, schemaPath.concat(['dependencies', key]))\n          validate('}')\n        }\n      })\n\n      if (type !== 'object') validate('}')\n    }\n\n    if (node.additionalProperties || node.additionalProperties === false) {\n      if (type !== 'object') validate('if (%s) {', types.object(name))\n\n      var i = genloop()\n      var keys = gensym('keys')\n\n      var toCompare = function(p) {\n        return keys+'['+i+'] !== '+JSON.stringify(p)\n      }\n\n      var toTest = function(p) {\n        return '!'+patterns(p)+'.test('+keys+'['+i+'])'\n      }\n\n      var additionalProp = Object.keys(properties || {}).map(toCompare)\n        .concat(Object.keys(node.patternProperties || {}).map(toTest))\n        .join(' && ') || 'true'\n\n      validate('var %s = Object.keys(%s)', keys, name)\n        ('for (var %s = 0; %s < %s.length; %s++) {', i, i, keys, i)\n          ('if (%s) {', additionalProp)\n\n      if (node.additionalProperties === false) {\n        if (filter) validate('delete %s', name+'['+keys+'['+i+']]')\n        error('has additional properties', null, JSON.stringify(name+'.') + ' + ' + keys + '['+i+']')\n      } else {\n        visit(name+'['+keys+'['+i+']]', node.additionalProperties, reporter, filter, schemaPath.concat(['additionalProperties']))\n      }\n\n      validate\n          ('}')\n        ('}')\n\n      if (type !== 'object') validate('}')\n    }\n\n    if (node.$ref) {\n      var sub = get(root, opts && opts.schemas || {}, node.$ref)\n      if (sub) {\n        var fn = cache[node.$ref]\n        if (!fn) {\n          cache[node.$ref] = function proxy(data) {\n            return fn(data)\n          }\n          fn = compile(sub, cache, root, false, opts)\n        }\n        var n = gensym('ref')\n        scope[n] = fn\n        validate('if (!(%s(%s))) {', n, name)\n        error('referenced schema does not match')\n        validate('}')\n      }\n    }\n\n    if (node.not) {\n      var prev = gensym('prev')\n      validate('var %s = errors', prev)\n      visit(name, node.not, false, filter, schemaPath.concat('not'))\n      validate('if (%s === errors) {', prev)\n      error('negative schema matches')\n      validate('} else {')\n        ('errors = %s', prev)\n      ('}')\n    }\n\n    if (node.items && !tuple) {\n      if (type !== 'array') validate('if (%s) {', types.array(name))\n\n      var i = genloop()\n      validate('for (var %s = 0; %s < %s.length; %s++) {', i, i, name, i)\n      visit(name+'['+i+']', node.items, reporter, filter, schemaPath.concat('items'))\n      validate('}')\n\n      if (type !== 'array') validate('}')\n    }\n\n    if (node.patternProperties) {\n      if (type !== 'object') validate('if (%s) {', types.object(name))\n      var keys = gensym('keys')\n      var i = genloop()\n      validate\n        ('var %s = Object.keys(%s)', keys, name)\n        ('for (var %s = 0; %s < %s.length; %s++) {', i, i, keys, i)\n\n      Object.keys(node.patternProperties).forEach(function(key) {\n        var p = patterns(key)\n        validate('if (%s.test(%s)) {', p, keys+'['+i+']')\n        visit(name+'['+keys+'['+i+']]', node.patternProperties[key], reporter, filter, schemaPath.concat(['patternProperties', key]))\n        validate('}')\n      })\n\n      validate('}')\n      if (type !== 'object') validate('}')\n    }\n\n    if (node.pattern) {\n      var p = patterns(node.pattern)\n      if (type !== 'string') validate('if (%s) {', types.string(name))\n      validate('if (!(%s.test(%s))) {', p, name)\n      error('pattern mismatch')\n      validate('}')\n      if (type !== 'string') validate('}')\n    }\n\n    if (node.allOf) {\n      node.allOf.forEach(function(sch, key) {\n        visit(name, sch, reporter, filter, schemaPath.concat(['allOf', key]))\n      })\n    }\n\n    if (node.anyOf && node.anyOf.length) {\n      var prev = gensym('prev')\n\n      node.anyOf.forEach(function(sch, i) {\n        if (i === 0) {\n          validate('var %s = errors', prev)\n        } else {\n          validate('if (errors !== %s) {', prev)\n            ('errors = %s', prev)\n        }\n        visit(name, sch, false, false, schemaPath)\n      })\n      node.anyOf.forEach(function(sch, i) {\n        if (i) validate('}')\n      })\n      validate('if (%s !== errors) {', prev)\n      error('no schemas match')\n      validate('}')\n    }\n\n    if (node.oneOf && node.oneOf.length) {\n      var prev = gensym('prev')\n      var passes = gensym('passes')\n\n      validate\n        ('var %s = errors', prev)\n        ('var %s = 0', passes)\n\n      node.oneOf.forEach(function(sch, i) {\n        visit(name, sch, false, false, schemaPath)\n        validate('if (%s === errors) {', prev)\n          ('%s++', passes)\n        ('} else {')\n          ('errors = %s', prev)\n        ('}')\n      })\n\n      validate('if (%s !== 1) {', passes)\n      error('no (or more than one) schemas match')\n      validate('}')\n    }\n\n    if (node.multipleOf !== undefined) {\n      if (type !== 'number' && type !== 'integer') validate('if (%s) {', types.number(name))\n\n      validate('if (!isMultipleOf(%s, %d)) {', name, node.multipleOf)\n\n      error('has a remainder')\n      validate('}')\n\n      if (type !== 'number' && type !== 'integer') validate('}')\n    }\n\n    if (node.maxProperties !== undefined) {\n      if (type !== 'object') validate('if (%s) {', types.object(name))\n\n      validate('if (Object.keys(%s).length > %d) {', name, node.maxProperties)\n      error('has more properties than allowed')\n      validate('}')\n\n      if (type !== 'object') validate('}')\n    }\n\n    if (node.minProperties !== undefined) {\n      if (type !== 'object') validate('if (%s) {', types.object(name))\n\n      validate('if (Object.keys(%s).length < %d) {', name, node.minProperties)\n      error('has less properties than allowed')\n      validate('}')\n\n      if (type !== 'object') validate('}')\n    }\n\n    if (node.maxItems !== undefined) {\n      if (type !== 'array') validate('if (%s) {', types.array(name))\n\n      validate('if (%s.length > %d) {', name, node.maxItems)\n      error('has more items than allowed')\n      validate('}')\n\n      if (type !== 'array') validate('}')\n    }\n\n    if (node.minItems !== undefined) {\n      if (type !== 'array') validate('if (%s) {', types.array(name))\n\n      validate('if (%s.length < %d) {', name, node.minItems)\n      error('has less items than allowed')\n      validate('}')\n\n      if (type !== 'array') validate('}')\n    }\n\n    if (node.maxLength !== undefined) {\n      if (type !== 'string') validate('if (%s) {', types.string(name))\n\n      validate('if (%s.length > %d) {', name, node.maxLength)\n      error('has longer length than allowed')\n      validate('}')\n\n      if (type !== 'string') validate('}')\n    }\n\n    if (node.minLength !== undefined) {\n      if (type !== 'string') validate('if (%s) {', types.string(name))\n\n      validate('if (%s.length < %d) {', name, node.minLength)\n      error('has less length than allowed')\n      validate('}')\n\n      if (type !== 'string') validate('}')\n    }\n\n    if (node.minimum !== undefined) {\n      if (type !== 'number' && type !== 'integer') validate('if (%s) {', types.number(name))\n\n      validate('if (%s %s %d) {', name, node.exclusiveMinimum ? '<=' : '<', node.minimum)\n      error('is less than minimum')\n      validate('}')\n\n      if (type !== 'number' && type !== 'integer') validate('}')\n    }\n\n    if (node.maximum !== undefined) {\n      if (type !== 'number' && type !== 'integer') validate('if (%s) {', types.number(name))\n\n      validate('if (%s %s %d) {', name, node.exclusiveMaximum ? '>=' : '>', node.maximum)\n      error('is more than maximum')\n      validate('}')\n\n      if (type !== 'number' && type !== 'integer') validate('}')\n    }\n\n    if (properties) {\n      Object.keys(properties).forEach(function(p) {\n        if (Array.isArray(type) && type.indexOf('null') !== -1) validate('if (%s !== null) {', name)\n\n        visit(\n          genobj(name, p),\n          properties[p],\n          reporter,\n          filter,\n          schemaPath.concat(tuple ? p : ['properties', p])\n        )\n\n        if (Array.isArray(type) && type.indexOf('null') !== -1) validate('}')\n      })\n    }\n\n    while (indent--) validate('}')\n  }\n\n  var validate = genfun\n    ('function validate(data) {')\n      // Since undefined is not a valid JSON value, we coerce to null and other checks will catch this\n      ('if (data === undefined) data = null')\n      ('validate.errors = null')\n      ('var errors = 0')\n\n  visit('data', schema, reporter, opts && opts.filter, [])\n\n  validate\n      ('return errors === 0')\n    ('}')\n\n  validate = validate.toFunction(scope)\n  validate.errors = null\n\n  if (Object.defineProperty) {\n    Object.defineProperty(validate, 'error', {\n      get: function() {\n        if (!validate.errors) return ''\n        return validate.errors.map(function(err) {\n          return err.field + ' ' + err.message;\n        }).join('\\n')\n      }\n    })\n  }\n\n  validate.toJSON = function() {\n    return schema\n  }\n\n  return validate\n}\n\nmodule.exports = function(schema, opts) {\n  if (typeof schema === 'string') schema = JSON.parse(schema)\n  return compile(schema, {}, schema, true, opts)\n}\n\nmodule.exports.filter = function(schema, opts) {\n  var validate = module.exports(schema, xtend(opts, {filter: true}))\n  return function(sch) {\n    validate(sch)\n    return sch\n  }\n}\n"]},"metadata":{},"sourceType":"script"}