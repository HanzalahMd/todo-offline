{"ast":null,"code":"/**\n * this plugin allows delta-updates with mongo-like-syntax\n * It's using modifyjs internally\n * @link https://github.com/lgandecki/modifyjs\n */\nimport modifyjs from 'modifyjs';\nexport function update(updateObj) {\n  var oldDocData = this._data;\n  var newDocData = modifyjs(oldDocData, updateObj);\n  return this._saveData(newDocData, oldDocData);\n}\nexport function RxQueryUpdate(updateObj) {\n  return this.exec().then(function (docs) {\n    if (!docs) return null;\n\n    if (Array.isArray(docs)) {\n      return Promise.all(docs.map(function (doc) {\n        return doc.update(updateObj);\n      })).then(function () {\n        return docs;\n      });\n    } else {\n      // via findOne()\n      return docs.update(updateObj).then(function () {\n        return docs;\n      });\n    }\n  });\n}\nexport var rxdb = true;\nexport var prototypes = {\n  RxDocument: function RxDocument(proto) {\n    proto.update = update;\n  },\n  RxQuery: function RxQuery(proto) {\n    proto.update = RxQueryUpdate;\n  }\n};\nexport var RxDBUpdatePlugin = {\n  name: 'update',\n  rxdb: rxdb,\n  prototypes: prototypes\n};","map":{"version":3,"sources":["/Users/Hanzalah/Desktop/github/todo-offline/rxdb-hasura-demo/node_modules/rxdb/dist/es/plugins/update.js"],"names":["modifyjs","update","updateObj","oldDocData","_data","newDocData","_saveData","RxQueryUpdate","exec","then","docs","Array","isArray","Promise","all","map","doc","rxdb","prototypes","RxDocument","proto","RxQuery","RxDBUpdatePlugin","name"],"mappings":"AAAA;;;;;AAKA,OAAOA,QAAP,MAAqB,UAArB;AACA,OAAO,SAASC,MAAT,CAAgBC,SAAhB,EAA2B;AAChC,MAAIC,UAAU,GAAG,KAAKC,KAAtB;AACA,MAAIC,UAAU,GAAGL,QAAQ,CAACG,UAAD,EAAaD,SAAb,CAAzB;AACA,SAAO,KAAKI,SAAL,CAAeD,UAAf,EAA2BF,UAA3B,CAAP;AACD;AACD,OAAO,SAASI,aAAT,CAAuBL,SAAvB,EAAkC;AACvC,SAAO,KAAKM,IAAL,GAAYC,IAAZ,CAAiB,UAAUC,IAAV,EAAgB;AACtC,QAAI,CAACA,IAAL,EAAW,OAAO,IAAP;;AAEX,QAAIC,KAAK,CAACC,OAAN,CAAcF,IAAd,CAAJ,EAAyB;AACvB,aAAOG,OAAO,CAACC,GAAR,CAAYJ,IAAI,CAACK,GAAL,CAAS,UAAUC,GAAV,EAAe;AACzC,eAAOA,GAAG,CAACf,MAAJ,CAAWC,SAAX,CAAP;AACD,OAFkB,CAAZ,EAEHO,IAFG,CAEE,YAAY;AACnB,eAAOC,IAAP;AACD,OAJM,CAAP;AAKD,KAND,MAMO;AACL;AACA,aAAOA,IAAI,CAACT,MAAL,CAAYC,SAAZ,EAAuBO,IAAvB,CAA4B,YAAY;AAC7C,eAAOC,IAAP;AACD,OAFM,CAAP;AAGD;AACF,GAfM,CAAP;AAgBD;AACD,OAAO,IAAIO,IAAI,GAAG,IAAX;AACP,OAAO,IAAIC,UAAU,GAAG;AACtBC,EAAAA,UAAU,EAAE,SAASA,UAAT,CAAoBC,KAApB,EAA2B;AACrCA,IAAAA,KAAK,CAACnB,MAAN,GAAeA,MAAf;AACD,GAHqB;AAItBoB,EAAAA,OAAO,EAAE,SAASA,OAAT,CAAiBD,KAAjB,EAAwB;AAC/BA,IAAAA,KAAK,CAACnB,MAAN,GAAeM,aAAf;AACD;AANqB,CAAjB;AAQP,OAAO,IAAIe,gBAAgB,GAAG;AAC5BC,EAAAA,IAAI,EAAE,QADsB;AAE5BN,EAAAA,IAAI,EAAEA,IAFsB;AAG5BC,EAAAA,UAAU,EAAEA;AAHgB,CAAvB","sourcesContent":["/**\n * this plugin allows delta-updates with mongo-like-syntax\n * It's using modifyjs internally\n * @link https://github.com/lgandecki/modifyjs\n */\nimport modifyjs from 'modifyjs';\nexport function update(updateObj) {\n  var oldDocData = this._data;\n  var newDocData = modifyjs(oldDocData, updateObj);\n  return this._saveData(newDocData, oldDocData);\n}\nexport function RxQueryUpdate(updateObj) {\n  return this.exec().then(function (docs) {\n    if (!docs) return null;\n\n    if (Array.isArray(docs)) {\n      return Promise.all(docs.map(function (doc) {\n        return doc.update(updateObj);\n      })).then(function () {\n        return docs;\n      });\n    } else {\n      // via findOne()\n      return docs.update(updateObj).then(function () {\n        return docs;\n      });\n    }\n  });\n}\nexport var rxdb = true;\nexport var prototypes = {\n  RxDocument: function RxDocument(proto) {\n    proto.update = update;\n  },\n  RxQuery: function RxQuery(proto) {\n    proto.update = RxQueryUpdate;\n  }\n};\nexport var RxDBUpdatePlugin = {\n  name: 'update',\n  rxdb: rxdb,\n  prototypes: prototypes\n};\n//# sourceMappingURL=update.js.map"]},"metadata":{},"sourceType":"module"}